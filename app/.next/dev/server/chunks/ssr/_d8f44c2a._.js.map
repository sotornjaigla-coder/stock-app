{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Pee17/STOCK-APP/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB"}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Pee17/STOCK-APP/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90\",\n        destructive:\n          \"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"span\"> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"span\"\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,uKAAG,EACvB,oZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,wKAAI,GAAG;IAE9B,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 65, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Pee17/STOCK-APP/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 167, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Pee17/STOCK-APP/lib/store.ts"],"sourcesContent":["export type Product = {\r\n  id: string;\r\n  barcode?: string;\r\n  sku: string;\r\n  name: string;\r\n  category?: string;\r\n  unit: string;\r\n  cost: number; // ต้นทุน\r\n  price: number; // ราคาขาย\r\n  stock: number;\r\n  minStock: number;\r\n  image?: string; // base64 ได้\r\n  isActive: boolean;\r\n};\r\n\r\nexport type Supplier = {\r\n  id: string;\r\n  name: string;\r\n  phone?: string;\r\n};\r\n\r\nexport type TxType = \"PURCHASE_IN\" | \"SALE_OUT\" | \"ADJUST\";\r\n\r\nexport type StockLedger = {\r\n  id: string;\r\n  productId: string;\r\n  type: TxType;\r\n  qty: number;\r\n  beforeStock: number;\r\n  afterStock: number;\r\n  refType?: \"SALE\" | \"PO\" | \"ADJUST\";\r\n  refId?: string;\r\n  at: number;\r\n};\r\n\r\nexport type Sale = {\r\n  id: string;\r\n  createdAt: number;\r\n  paymentType: \"cash\" | \"transfer\" | \"promptpay\";\r\n  discount: number;\r\n  total: number;\r\n};\r\n\r\nexport type SaleItem = {\r\n  id: string;\r\n  saleId: string;\r\n  productId: string;\r\n  nameAtSale: string;\r\n  priceAtSale: number;\r\n  costAtSale: number;\r\n  qty: number;\r\n  lineTotal: number;\r\n};\r\n\r\nconst KEY_PRODUCTS = \"mm_products_v1\";\r\nconst KEY_LEDGER = \"mm_ledger_v1\";\r\nconst KEY_SALES = \"mm_sales_v1\";\r\nconst KEY_SALE_ITEMS = \"mm_sale_items_v1\";\r\n\r\nfunction safeParse<T>(raw: string | null, fallback: T): T {\r\n  if (!raw) return fallback;\r\n  try {\r\n    return JSON.parse(raw) as T;\r\n  } catch {\r\n    return fallback;\r\n  }\r\n}\r\n\r\nexport function loadProducts(): Product[] {\r\n  if (typeof window === \"undefined\") return [];\r\n  return safeParse<Product[]>(localStorage.getItem(KEY_PRODUCTS), []);\r\n}\r\n\r\nexport function saveProducts(products: Product[]) {\r\n  if (typeof window === \"undefined\") return;\r\n  localStorage.setItem(KEY_PRODUCTS, JSON.stringify(products));\r\n}\r\n\r\nexport function loadLedger(): StockLedger[] {\r\n  if (typeof window === \"undefined\") return [];\r\n  return safeParse<StockLedger[]>(localStorage.getItem(KEY_LEDGER), []);\r\n}\r\n\r\nexport function saveLedger(rows: StockLedger[]) {\r\n  if (typeof window === \"undefined\") return;\r\n  localStorage.setItem(KEY_LEDGER, JSON.stringify(rows));\r\n}\r\n\r\nexport function loadSales(): Sale[] {\r\n  if (typeof window === \"undefined\") return [];\r\n  return safeParse<Sale[]>(localStorage.getItem(KEY_SALES), []);\r\n}\r\n\r\nexport function saveSales(rows: Sale[]) {\r\n  if (typeof window === \"undefined\") return;\r\n  localStorage.setItem(KEY_SALES, JSON.stringify(rows));\r\n}\r\n\r\nexport function loadSaleItems(): SaleItem[] {\r\n  if (typeof window === \"undefined\") return [];\r\n  return safeParse<SaleItem[]>(localStorage.getItem(KEY_SALE_ITEMS), []);\r\n}\r\n\r\nexport function saveSaleItems(rows: SaleItem[]) {\r\n  if (typeof window === \"undefined\") return;\r\n  localStorage.setItem(KEY_SALE_ITEMS, JSON.stringify(rows));\r\n}\r\n\r\nexport function seedIfEmpty() {\r\n  const products = loadProducts();\r\n  if (products.length > 0) return;\r\n\r\n  const seeded: Product[] = [\r\n    {\r\n      id: crypto.randomUUID(),\r\n      barcode: \"8850001112223\",\r\n      sku: \"P001\",\r\n      name: \"น้ำดื่ม 600ml\",\r\n      category: \"เครื่องดื่ม\",\r\n      unit: \"ขวด\",\r\n      cost: 5,\r\n      price: 10,\r\n      stock: 50,\r\n      minStock: 10,\r\n      isActive: true,\r\n    },\r\n    {\r\n      id: crypto.randomUUID(),\r\n      barcode: \"8850003334445\",\r\n      sku: \"P002\",\r\n      name: \"มาม่าต้มยำกุ้ง\",\r\n      category: \"อาหารแห้ง\",\r\n      unit: \"ซอง\",\r\n      cost: 4,\r\n      price: 7,\r\n      stock: 80,\r\n      minStock: 20,\r\n      isActive: true,\r\n    },\r\n    {\r\n      id: crypto.randomUUID(),\r\n      barcode: \"8850007778889\",\r\n      sku: \"P003\",\r\n      name: \"โค้กกระป๋อง\",\r\n      category: \"เครื่องดื่ม\",\r\n      unit: \"กระป๋อง\",\r\n      cost: 10,\r\n      price: 15,\r\n      stock: 30,\r\n      minStock: 10,\r\n      isActive: true,\r\n    },\r\n  ];\r\n\r\n  saveProducts(seeded);\r\n}\r\n\r\nexport function addProduct(p: Omit<Product, \"id\" | \"stock\"> & { stock?: number }) {\r\n  const products = loadProducts();\r\n  const next: Product = {\r\n    id: crypto.randomUUID(),\r\n    stock: p.stock ?? 0,\r\n    ...p,\r\n  };\r\n  saveProducts([next, ...products]);\r\n}\r\n\r\nexport function deleteProduct(id: string) {\r\n  const products = loadProducts();\r\n  saveProducts(products.filter((p) => p.id !== id));\r\n}\r\n\r\nexport function adjustStock(productId: string, qtyDelta: number, reason: TxType = \"ADJUST\") {\r\n  const products = loadProducts();\r\n  const idx = products.findIndex((p) => p.id === productId);\r\n  if (idx === -1) return;\r\n\r\n  const before = products[idx].stock;\r\n  const after = Math.max(0, before + qtyDelta);\r\n  products[idx] = { ...products[idx], stock: after };\r\n  saveProducts(products);\r\n\r\n  const ledger = loadLedger();\r\n  ledger.unshift({\r\n    id: crypto.randomUUID(),\r\n    productId,\r\n    type: reason,\r\n    qty: Math.abs(qtyDelta),\r\n    beforeStock: before,\r\n    afterStock: after,\r\n    refType: \"ADJUST\",\r\n    refId: undefined,\r\n    at: Date.now(),\r\n  });\r\n  saveLedger(ledger);\r\n}\r\n\r\nexport function findProductByBarcode(barcode: string): Product | undefined {\r\n  const products = loadProducts();\r\n  return products.find((p) => p.barcode === barcode && p.isActive);\r\n}\r\n\r\nexport type CartItem = {\r\n  productId: string;\r\n  name: string;\r\n  price: number;\r\n  cost: number;\r\n  qty: number;\r\n};\r\n\r\nexport function checkoutSale(args: {\r\n  cart: CartItem[];\r\n  paymentType: Sale[\"paymentType\"];\r\n  discount: number;\r\n}) {\r\n  const { cart, paymentType, discount } = args;\r\n\r\n  if (cart.length === 0) throw new Error(\"Cart is empty\");\r\n\r\n  const products = loadProducts();\r\n\r\n  // Validate stock\r\n  for (const item of cart) {\r\n    const p = products.find((x) => x.id === item.productId);\r\n    if (!p) throw new Error(\"Product not found\");\r\n    if (p.stock < item.qty) throw new Error(`Stock not enough: ${p.name}`);\r\n  }\r\n\r\n  const saleId = crypto.randomUUID();\r\n  const subtotal = cart.reduce((sum, i) => sum + i.price * i.qty, 0);\r\n  const total = Math.max(0, subtotal - discount);\r\n\r\n  const sale: Sale = {\r\n    id: saleId,\r\n    createdAt: Date.now(),\r\n    paymentType,\r\n    discount,\r\n    total,\r\n  };\r\n\r\n  const saleItems: SaleItem[] = cart.map((i) => ({\r\n    id: crypto.randomUUID(),\r\n    saleId,\r\n    productId: i.productId,\r\n    nameAtSale: i.name,\r\n    priceAtSale: i.price,\r\n    costAtSale: i.cost,\r\n    qty: i.qty,\r\n    lineTotal: i.price * i.qty,\r\n  }));\r\n\r\n  // Update stock + ledger\r\n  const ledger = loadLedger();\r\n  for (const item of cart) {\r\n    const idx = products.findIndex((p) => p.id === item.productId);\r\n    const before = products[idx].stock;\r\n    const after = before - item.qty;\r\n    products[idx] = { ...products[idx], stock: after };\r\n\r\n    ledger.unshift({\r\n      id: crypto.randomUUID(),\r\n      productId: item.productId,\r\n      type: \"SALE_OUT\",\r\n      qty: item.qty,\r\n      beforeStock: before,\r\n      afterStock: after,\r\n      refType: \"SALE\",\r\n      refId: saleId,\r\n      at: Date.now(),\r\n    });\r\n  }\r\n\r\n  saveProducts(products);\r\n  saveLedger(ledger);\r\n\r\n  const sales = loadSales();\r\n  sales.unshift(sale);\r\n  saveSales(sales);\r\n\r\n  const allSaleItems = loadSaleItems();\r\n  saveSaleItems([...saleItems, ...allSaleItems]);\r\n\r\n  return { sale, saleItems };\r\n}\r\n\r\nexport function getTodaySummary() {\r\n  const now = new Date();\r\n  const start = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();\r\n  const end = start + 24 * 60 * 60 * 1000;\r\n\r\n  const sales = loadSales().filter((s) => s.createdAt >= start && s.createdAt < end);\r\n  const saleItems = loadSaleItems();\r\n\r\n  const totalSales = sales.reduce((sum, s) => sum + s.total, 0);\r\n  const totalBills = sales.length;\r\n\r\n  const grossProfit = sales.reduce((sum, s) => {\r\n    const items = saleItems.filter((i) => i.saleId === s.id);\r\n    const gp = items.reduce((acc, it) => acc + (it.priceAtSale - it.costAtSale) * it.qty, 0);\r\n    return sum + gp;\r\n  }, 0);\r\n\r\n  return { totalSales, totalBills, grossProfit };\r\n}\r\n\r\nexport function getLowStockProducts() {\r\n  const products = loadProducts();\r\n  return products.filter((p) => p.isActive && p.stock <= p.minStock);\r\n}\r\nexport function exportSalesCSV() {\r\n  const sales = loadSales();\r\n  const items = loadSaleItems();\r\n\r\n  const header = [\r\n    \"saleId\",\r\n    \"createdAt\",\r\n    \"paymentType\",\r\n    \"discount\",\r\n    \"total\",\r\n    \"productName\",\r\n    \"qty\",\r\n    \"priceAtSale\",\r\n    \"lineTotal\",\r\n  ].join(\",\");\r\n\r\n  const rows: string[] = [header];\r\n\r\n  for (const s of sales) {\r\n    const it = items.filter((x) => x.saleId === s.id);\r\n    for (const row of it) {\r\n      rows.push(\r\n        [\r\n          s.id,\r\n          new Date(s.createdAt).toISOString(),\r\n          s.paymentType,\r\n          s.discount,\r\n          s.total,\r\n          `\"${row.nameAtSale.replace(/\"/g, '\"\"')}\"`,\r\n          row.qty,\r\n          row.priceAtSale,\r\n          row.lineTotal,\r\n        ].join(\",\")\r\n      );\r\n    }\r\n  }\r\n\r\n  return rows.join(\"\\n\");\r\n}\r\nexport function getActiveProducts() {\r\n  return loadProducts().filter((p) => p.isActive);\r\n}\r\n// ==============================\r\n// ✅ BACKOFFICE FEATURES\r\n// ==============================\r\n\r\nexport type GRN = {\r\n  id: string;\r\n  docNo: string; // GRN-2026-0001\r\n  supplierName?: string;\r\n  createdAt: number;\r\n  note?: string;\r\n  items: GRNItem[];\r\n  totalCost: number;\r\n};\r\n\r\nexport type GRNItem = {\r\n  productId: string;\r\n  name: string;\r\n  qty: number;\r\n  cost: number;\r\n  lineTotal: number;\r\n};\r\n\r\nexport type AdjustmentReason =\r\n  | \"DAMAGED\"\r\n  | \"LOST\"\r\n  | \"EXPIRED\"\r\n  | \"COUNT_DIFF\"\r\n  | \"SYSTEM_FIX\"\r\n  | \"OTHER\";\r\n\r\nexport type AdjustmentDoc = {\r\n  id: string;\r\n  createdAt: number;\r\n  reason: AdjustmentReason;\r\n  note?: string;\r\n  items: AdjustmentItem[];\r\n};\r\n\r\nexport type AdjustmentItem = {\r\n  productId: string;\r\n  name: string;\r\n  beforeStock: number;\r\n  afterStock: number;\r\n  diff: number;\r\n};\r\n\r\nexport type CountSession = {\r\n  id: string;\r\n  docNo: string; // COUNT-2026-0001\r\n  createdAt: number;\r\n  status: \"DRAFT\" | \"POSTED\";\r\n  note?: string;\r\n  rows: CountRow[];\r\n};\r\n\r\nexport type CountRow = {\r\n  productId: string;\r\n  name: string;\r\n  systemStock: number;\r\n  countedStock: number;\r\n  diff: number;\r\n};\r\n\r\nconst KEY_GRNS = \"mm_grn_v1\";\r\nconst KEY_ADJUST_DOCS = \"mm_adjust_docs_v1\";\r\nconst KEY_COUNTS = \"mm_count_sessions_v1\";\r\nexport function loadGRNs(): GRN[] {\r\n  if (typeof window === \"undefined\") return [];\r\n  return safeParse<GRN[]>(localStorage.getItem(KEY_GRNS), []);\r\n}\r\nexport function saveGRNs(rows: GRN[]) {\r\n  if (typeof window === \"undefined\") return;\r\n  localStorage.setItem(KEY_GRNS, JSON.stringify(rows));\r\n}\r\n\r\nexport function loadAdjustmentDocs(): AdjustmentDoc[] {\r\n  if (typeof window === \"undefined\") return [];\r\n  return safeParse<AdjustmentDoc[]>(localStorage.getItem(KEY_ADJUST_DOCS), []);\r\n}\r\nexport function saveAdjustmentDocs(rows: AdjustmentDoc[]) {\r\n  if (typeof window === \"undefined\") return;\r\n  localStorage.setItem(KEY_ADJUST_DOCS, JSON.stringify(rows));\r\n}\r\n\r\nexport function loadCountSessions(): CountSession[] {\r\n  if (typeof window === \"undefined\") return [];\r\n  return safeParse<CountSession[]>(localStorage.getItem(KEY_COUNTS), []);\r\n}\r\nexport function saveCountSessions(rows: CountSession[]) {\r\n  if (typeof window === \"undefined\") return;\r\n  localStorage.setItem(KEY_COUNTS, JSON.stringify(rows));\r\n}\r\nfunction pad4(n: number) {\r\n  return String(n).padStart(4, \"0\");\r\n}\r\n\r\nfunction nextDocNo(prefix: string, existing: { docNo: string }[]) {\r\n  const year = new Date().getFullYear();\r\n  const start = `${prefix}-${year}-`;\r\n  const nums = existing\r\n    .filter((x) => x.docNo.startsWith(start))\r\n    .map((x) => Number(x.docNo.replace(start, \"\")))\r\n    .filter((n) => Number.isFinite(n));\r\n  const next = (nums.length ? Math.max(...nums) : 0) + 1;\r\n  return `${prefix}-${year}-${pad4(next)}`;\r\n}\r\nexport function createGRN(args: {\r\n  supplierName?: string;\r\n  note?: string;\r\n  items: { productId: string; qty: number; cost: number }[];\r\n}) {\r\n  const products = loadProducts();\r\n  const grns = loadGRNs();\r\n\r\n  const docNo = nextDocNo(\"GRN\", grns);\r\n  const id = crypto.randomUUID();\r\n\r\n  let totalCost = 0;\r\n\r\n  const grnItems: GRNItem[] = args.items.map((it) => {\r\n    const p = products.find((x) => x.id === it.productId);\r\n    if (!p) throw new Error(\"Product not found\");\r\n\r\n    const lineTotal = it.qty * it.cost;\r\n    totalCost += lineTotal;\r\n\r\n    return {\r\n      productId: it.productId,\r\n      name: p.name,\r\n      qty: it.qty,\r\n      cost: it.cost,\r\n      lineTotal,\r\n    };\r\n  });\r\n\r\n  // update stock + ledger\r\n  const ledger = loadLedger();\r\n  for (const it of grnItems) {\r\n    const idx = products.findIndex((p) => p.id === it.productId);\r\n    const before = products[idx].stock;\r\n    const after = before + it.qty;\r\n\r\n    // update stock\r\n    products[idx] = { ...products[idx], stock: after, cost: it.cost }; // update cost ล่าสุด\r\n\r\n    ledger.unshift({\r\n      id: crypto.randomUUID(),\r\n      productId: it.productId,\r\n      type: \"PURCHASE_IN\",\r\n      qty: it.qty,\r\n      beforeStock: before,\r\n      afterStock: after,\r\n      refType: \"PO\",\r\n      refId: id,\r\n      at: Date.now(),\r\n    });\r\n  }\r\n\r\n  saveProducts(products);\r\n  saveLedger(ledger);\r\n\r\n  const grn: GRN = {\r\n    id,\r\n    docNo,\r\n    supplierName: args.supplierName,\r\n    createdAt: Date.now(),\r\n    note: args.note,\r\n    items: grnItems,\r\n    totalCost,\r\n  };\r\n\r\n  grns.unshift(grn);\r\n  saveGRNs(grns);\r\n\r\n  return grn;\r\n}\r\nexport function createAdjustment(args: {\r\n  reason: AdjustmentReason;\r\n  note?: string;\r\n  items: { productId: string; afterStock: number }[];\r\n}) {\r\n  const products = loadProducts();\r\n  const ledger = loadLedger();\r\n\r\n  const doc: AdjustmentDoc = {\r\n    id: crypto.randomUUID(),\r\n    createdAt: Date.now(),\r\n    reason: args.reason,\r\n    note: args.note,\r\n    items: [],\r\n  };\r\n\r\n  for (const it of args.items) {\r\n    const idx = products.findIndex((p) => p.id === it.productId);\r\n    if (idx === -1) continue;\r\n\r\n    const before = products[idx].stock;\r\n    const after = Math.max(0, it.afterStock);\r\n    const diff = after - before;\r\n\r\n    products[idx] = { ...products[idx], stock: after };\r\n\r\n    doc.items.push({\r\n      productId: it.productId,\r\n      name: products[idx].name,\r\n      beforeStock: before,\r\n      afterStock: after,\r\n      diff,\r\n    });\r\n\r\n    if (diff !== 0) {\r\n      ledger.unshift({\r\n        id: crypto.randomUUID(),\r\n        productId: it.productId,\r\n        type: \"ADJUST\",\r\n        qty: Math.abs(diff),\r\n        beforeStock: before,\r\n        afterStock: after,\r\n        refType: \"ADJUST\",\r\n        refId: doc.id,\r\n        at: Date.now(),\r\n      });\r\n    }\r\n  }\r\n\r\n  saveProducts(products);\r\n  saveLedger(ledger);\r\n\r\n  const docs = loadAdjustmentDocs();\r\n  docs.unshift(doc);\r\n  saveAdjustmentDocs(docs);\r\n\r\n  return doc;\r\n}\r\nexport function createCountSession(note?: string) {\r\n  const sessions = loadCountSessions();\r\n  const docNo = nextDocNo(\"COUNT\", sessions);\r\n\r\n  const products = loadProducts().filter((p) => p.isActive);\r\n\r\n  const session: CountSession = {\r\n    id: crypto.randomUUID(),\r\n    docNo,\r\n    createdAt: Date.now(),\r\n    status: \"DRAFT\",\r\n    note,\r\n    rows: products.map((p) => ({\r\n      productId: p.id,\r\n      name: p.name,\r\n      systemStock: p.stock,\r\n      countedStock: p.stock,\r\n      diff: 0,\r\n    })),\r\n  };\r\n\r\n  sessions.unshift(session);\r\n  saveCountSessions(sessions);\r\n\r\n  return session;\r\n}\r\n\r\nexport function updateCountRow(sessionId: string, productId: string, countedStock: number) {\r\n  const sessions = loadCountSessions();\r\n  const idx = sessions.findIndex((s) => s.id === sessionId);\r\n  if (idx === -1) return;\r\n\r\n  const s = sessions[idx];\r\n  if (s.status !== \"DRAFT\") return;\r\n\r\n  s.rows = s.rows.map((r) => {\r\n    if (r.productId !== productId) return r;\r\n    const counted = Math.max(0, countedStock);\r\n    const diff = counted - r.systemStock;\r\n    return { ...r, countedStock: counted, diff };\r\n  });\r\n\r\n  sessions[idx] = s;\r\n  saveCountSessions(sessions);\r\n}\r\n\r\nexport function postCountSession(sessionId: string) {\r\n  const sessions = loadCountSessions();\r\n  const idx = sessions.findIndex((s) => s.id === sessionId);\r\n  if (idx === -1) throw new Error(\"Count session not found\");\r\n\r\n  const session = sessions[idx];\r\n  if (session.status !== \"DRAFT\") throw new Error(\"Already posted\");\r\n\r\n  // ทำ adjustment ตาม diff\r\n  const adjustmentItems = session.rows\r\n    .filter((r) => r.diff !== 0)\r\n    .map((r) => ({\r\n      productId: r.productId,\r\n      afterStock: r.countedStock,\r\n    }));\r\n\r\n  if (adjustmentItems.length > 0) {\r\n    createAdjustment({\r\n      reason: \"COUNT_DIFF\",\r\n      note: `Cycle Count ${session.docNo}`,\r\n      items: adjustmentItems,\r\n    });\r\n  }\r\n\r\n  session.status = \"POSTED\";\r\n  sessions[idx] = session;\r\n  saveCountSessions(sessions);\r\n\r\n  return session;\r\n}\r\nexport function exportProductsCSV() {\r\n  const rows = loadProducts();\r\n  const header = [\r\n    \"sku\",\r\n    \"barcode\",\r\n    \"name\",\r\n    \"category\",\r\n    \"unit\",\r\n    \"cost\",\r\n    \"price\",\r\n    \"stock\",\r\n    \"minStock\",\r\n    \"isActive\",\r\n  ].join(\",\");\r\n\r\n  const lines = [header];\r\n\r\n  for (const p of rows) {\r\n    lines.push(\r\n      [\r\n        p.sku,\r\n        p.barcode ?? \"\",\r\n        `\"${p.name.replace(/\"/g, '\"\"')}\"`,\r\n        p.category ?? \"\",\r\n        p.unit,\r\n        p.cost,\r\n        p.price,\r\n        p.stock,\r\n        p.minStock,\r\n        p.isActive ? \"1\" : \"0\",\r\n      ].join(\",\")\r\n    );\r\n  }\r\n  return lines.join(\"\\n\");\r\n}\r\n\r\nexport function importProductsCSV(csv: string) {\r\n  const lines = csv.split(/\\r?\\n/).filter((x) => x.trim());\r\n  if (lines.length <= 1) return;\r\n\r\n  const [header, ...rows] = lines;\r\n  const cols = header.split(\",\").map((x) => x.trim());\r\n\r\n  const get = (arr: string[], key: string) => {\r\n    const i = cols.indexOf(key);\r\n    return i >= 0 ? (arr[i] ?? \"\").trim() : \"\";\r\n  };\r\n\r\n  const products = loadProducts();\r\n\r\n  for (const line of rows) {\r\n    const arr = line.split(\",\"); // NOTE: csv แบบง่าย ไม่รองรับ comma ในชื่อ (เรา quote ชื่อไว้แล้ว)\r\n\r\n    const sku = get(arr, \"sku\");\r\n    const name = get(arr, \"name\").replace(/^\"|\"$/g, \"\");\r\n    if (!sku || !name) continue;\r\n\r\n    const barcode = get(arr, \"barcode\") || undefined;\r\n\r\n    const next: Product = {\r\n      id: crypto.randomUUID(),\r\n      sku,\r\n      barcode,\r\n      name,\r\n      category: get(arr, \"category\") || \"ทั่วไป\",\r\n      unit: get(arr, \"unit\") || \"ชิ้น\",\r\n      cost: Number(get(arr, \"cost\") || 0),\r\n      price: Number(get(arr, \"price\") || 0),\r\n      stock: Number(get(arr, \"stock\") || 0),\r\n      minStock: Number(get(arr, \"minStock\") || 0),\r\n      image: undefined,\r\n      isActive: get(arr, \"isActive\") !== \"0\",\r\n    };\r\n\r\n    products.unshift(next);\r\n  }\r\n\r\n  saveProducts(products);\r\n}\r\nexport function getStockValuation() {\r\n  const products = loadProducts().filter((p) => p.isActive);\r\n\r\n  const rows = products.map((p) => ({\r\n    id: p.id,\r\n    name: p.name,\r\n    sku: p.sku,\r\n    stock: p.stock,\r\n    cost: p.cost,\r\n    value: p.stock * p.cost,\r\n  }));\r\n\r\n  const totalValue = rows.reduce((sum, r) => sum + r.value, 0);\r\n\r\n  return { rows, totalValue };\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 804, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Pee17/STOCK-APP/app/valuation/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Card, CardContent } from \"@/components/ui/card\";\r\nimport { getStockValuation, seedIfEmpty } from \"@/lib/store\";\r\n\r\nexport default function ValuationPage() {\r\n  const [data, setData] = useState(() => getStockValuation());\r\n\r\n  useEffect(() => {\r\n    seedIfEmpty();\r\n    setData(getStockValuation());\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex items-end justify-between\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold\">Stock Valuation</h1>\r\n          <p className=\"text-sm text-slate-500\">มูลค่าสต๊อก (ต้นทุน x จำนวนคงเหลือ)</p>\r\n        </div>\r\n        <Badge variant=\"secondary\">Backoffice</Badge>\r\n      </div>\r\n\r\n      <Card className=\"rounded-2xl\">\r\n        <CardContent className=\"p-4\">\r\n          <div className=\"text-sm text-slate-500\">มูลค่าสต๊อกรวม</div>\r\n          <div className=\"mt-1 text-3xl font-bold\">{data.totalValue}</div>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      <Card className=\"rounded-2xl\">\r\n        <CardContent className=\"p-4 space-y-2\">\r\n          {data.rows.map((r) => (\r\n            <div key={r.id} className=\"flex items-center justify-between rounded-xl border bg-white p-3\">\r\n              <div>\r\n                <div className=\"font-semibold\">{r.name}</div>\r\n                <div className=\"text-xs text-slate-500\">SKU: {r.sku}</div>\r\n              </div>\r\n              <div className=\"text-right\">\r\n                <div className=\"text-sm font-semibold\">\r\n                  {r.stock} x {r.cost} = {r.value}\r\n                </div>\r\n                <div className=\"text-xs text-slate-500\">ต้นทุนต่อหน่วย</div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAOe,SAAS;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC,IAAM,IAAA,iIAAiB;IAExD,IAAA,kNAAS,EAAC;QACR,IAAA,2HAAW;QACX,QAAQ,IAAA,iIAAiB;IAC3B,GAAG,EAAE;IAEL,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;;0CACC,8OAAC;gCAAG,WAAU;0CAAqB;;;;;;0CACnC,8OAAC;gCAAE,WAAU;0CAAyB;;;;;;;;;;;;kCAExC,8OAAC,mIAAK;wBAAC,SAAQ;kCAAY;;;;;;;;;;;;0BAG7B,8OAAC,iIAAI;gBAAC,WAAU;0BACd,cAAA,8OAAC,wIAAW;oBAAC,WAAU;;sCACrB,8OAAC;4BAAI,WAAU;sCAAyB;;;;;;sCACxC,8OAAC;4BAAI,WAAU;sCAA2B,KAAK,UAAU;;;;;;;;;;;;;;;;;0BAI7D,8OAAC,iIAAI;gBAAC,WAAU;0BACd,cAAA,8OAAC,wIAAW;oBAAC,WAAU;8BACpB,KAAK,IAAI,CAAC,GAAG,CAAC,CAAC,kBACd,8OAAC;4BAAe,WAAU;;8CACxB,8OAAC;;sDACC,8OAAC;4CAAI,WAAU;sDAAiB,EAAE,IAAI;;;;;;sDACtC,8OAAC;4CAAI,WAAU;;gDAAyB;gDAAM,EAAE,GAAG;;;;;;;;;;;;;8CAErD,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAI,WAAU;;gDACZ,EAAE,KAAK;gDAAC;gDAAI,EAAE,IAAI;gDAAC;gDAAI,EAAE,KAAK;;;;;;;sDAEjC,8OAAC;4CAAI,WAAU;sDAAyB;;;;;;;;;;;;;2BATlC,EAAE,EAAE;;;;;;;;;;;;;;;;;;;;;AAiB1B"}}]
}